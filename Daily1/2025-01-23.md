### Always show the tag <foreignObject> is unrecognized in this browser.

> Issue #32199 - [View on GitHub](https://github.com/facebook/react/issues/32199)

### Website or app

Sorry cannot share it since its private

### Repro steps

Chrome: Version 132.0.6834.111 (Official Build) (arm64)
react: 17.0.2
![Image](https://github.com/user-attachments/assets/7e5b0e75-f7e0-4a01-b586-8af00aaaca7a)
I know react support svg element but why i can see warning in console?

### How often does this bug happen?

Every time

### DevTools package (automated)

_No response_

### DevTools version (automated)

_No response_

### Error message (automated)

_No response_

### Error call stack (automated)

```text

```

### Error component stack (automated)

```text

```

### GitHub query string (automated)

```text

```

---

### [DevTools Bug]:  Support Iterables in React DevTools

> Issue #32192 - [View on GitHub](https://github.com/facebook/react/issues/32192)

### Website or app

React DevTools

### Repro steps

1.Open a React app using React 19.0.0.
2.Pass an Iterable<T> to a component's props or state.
3.Inspect the component using React DevTools.
4.Observe the display or handling of the Iterable.

### How often does this bug happen?

Every time

### DevTools package (automated)

_No response_

### DevTools version (automated)

_No response_

### Error message (automated)

_No response_

### Error call stack (automated)

```text

```

### Error component stack (automated)

```text

```

### GitHub query string (automated)

```text

```

---

### Bug:

> Issue #32191 - [View on GitHub](https://github.com/facebook/react/issues/32191)

<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior


---

### [Compiler Bug]:  Incorrect Optimization of JS Output

> Issue #32189 - [View on GitHub](https://github.com/facebook/react/issues/32189)

### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

-

### Repro steps

1.Log in to the app.
2.Perform an action that triggers React Compiler optimization (e.g., render a specific component).
3.Observe that the output JS is incorrect, leading to broken functionality.

### How often does this bug happen?

Every time

### What version of React are you using?

18

### What version of React Compiler are you using?

18.0.0

---

### Bug:

> Issue #32187 - [View on GitHub](https://github.com/facebook/react/issues/32187)

<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior


---

### Bug:

> Issue #32186 - [View on GitHub](https://github.com/facebook/react/issues/32186)

<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior


---

### Bug:

> Issue #32185 - [View on GitHub](https://github.com/facebook/react/issues/32185)

<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior


---

### Bug:

> Issue #32184 - [View on GitHub](https://github.com/facebook/react/issues/32184)

Status: Unconfirmed
A potential issue that we haven't yet confirmed as a bug

---

### Bug:

> Issue #32180 - [View on GitHub](https://github.com/facebook/react/issues/32180)

<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior


---

### Bug:

> Issue #32179 - [View on GitHub](https://github.com/facebook/react/issues/32179)

<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior


---

### Bug: Fix Buffer - Write Chunks to Separate Buffers

> Issue #32176 - [View on GitHub](https://github.com/facebook/react/issues/32176)

<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->
The bug happens when using ReactDOMFizzServer.renderToReadableStream to render big chunks of data. If a chunk is bigger than the buffer (default: 512 bytes), the buffer overflows or uses incomplete data. This causes wrong or cut-off output because the renderer doesnâ€™t handle buffer size properly.

React version:
React 19.0.0

## Steps To Reproduce
1. Create a large chunk of data that is bigger than the buffer size.
2. Start processing the data using `ReactDOMFizzServer.renderToReadableStream`.  
3. Observe the behavior when the chunks exceed the buffer size.  

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->
```
import ReactDOMFizzServer from 'react-dom/server';

// Minimal data to reproduce the problem
const largeChunk = 'A'.repeat(2049); // A chunk exceeding  default 512 bytes

async function testStream() {
  //  simple React structure with the large chunk
  const stream = await ReactDOMFizzServer.renderToReadableStream(
    <div>{largeChunk}</div>
  );

  // function to read the stream
  const decoder = new TextDecoder();
  const reader = stream.getReader();
  let result = '';
  while (true) {
    const { done, value } = await reader.read();
    if (done) break;
    result += decoder.decode(value);
  }

  console.log(result);
}

testStream();
```

## The current behavior
Right now, when chunks are sent to a `ReadableStream`, they are enqueued directly without checking the buffer size. If a chunk is too big (like 2049 bytes, while the buffer is only 512 bytes), it reuses old buffers, which messes up the output. For example, instead of properly rendering, we get something like ```<div>AAAAA...</div>```.

## The expected behavior
Chunks should be written to their own buffer and split into smaller parts if they are too big. The buffer should only be sent once it's full or the writing is complete. This way, even large chunks (like 2049 bytes) will render correctly, for example: ```<div>AAAAAAAAAAAAAAAAA...</div>```.




---

### Bug: Ensure createRoot warning parity with ReactDOM.render

> Issue #32175 - [View on GitHub](https://github.com/facebook/react/issues/32175)

Ensure createRoot warning parity with ReactDOM.render

### Description

This PR addresses an internal task to bring over some pre-existing warnings for `ReactDOM.render()` to `createRoot()`, ensuring parity in warning behavior. Specifically, warnings related to failing to clear an existing React tree should now also trigger for roots.

### Steps to Reproduce

1. Use `ReactDOM.render()` with a non-empty container.
2. Use `createRoot()` with a non-empty container.
3. Observe that warnings for `ReactDOM.render()` appear, but not for `createRoot()`.

### Expected Behavior

Warnings for failing to clear the React tree should trigger for both `ReactDOM.render()` and `createRoot()`.

### Actual Behavior

Warnings appear only for `ReactDOM.render()` and not for `createRoot()`.

### Environment

- React Version: 16.13.0
- Browser: Chrome
- Node Version: 12.18.0


---

### Bug: Inconsistent enhanced error messages for incorrect hook calls

> Issue #32174 - [View on GitHub](https://github.com/facebook/react/issues/32174)

<!--
  PR #18480 included new error messages for invalid hook calls, but they don't always show up the way they should. The error message may not show up in some situations or may be ambiguous or inconsistent.
-->

React version: React 18.0.0 (also tested with React 19 beta)

## Steps To Reproduce

1.Use a React hook (like useState) outside of a custom hook or functional component.
2.Launch the program and look for error messages in the console.


Link to code example: https://codesandbox.io/s/new


## The current behavior
The message of error:

does not show up in certain situations.
appears, but offers no clear or practical advice on the matter.



## The expected behavior
The error message ought to:

When hooks are utilized improperly, they always show up.
Give precise, succinct, and doable instructions for fixing the problem.


---

### Bug: Hydration Gaps and Dropped Events in Concurrent and Suspense Hydration

> Issue #32173 - [View on GitHub](https://github.com/facebook/react/issues/32173)

<!--
 There is a delay between calling createRoot or createSyncRoot and committing the hydrated tree, leading to gaps in rendering. During these gaps, events issued on dehydrated DOM nodes are dropped. This issue is more prominent in batched and concurrent modes, where there are delays in starting the render or during yielding. For Suspense boundaries, Partial Hydration also introduces gaps between rendering levels. This problem prevents certain user events from being handled correctly until after the tree is fully hydrated.
-->

React version: 2.3.1

## Steps To Reproduce

1.Use React with Suspense boundaries or in concurrent mode.
2.Trigger events (e.g., click, text input) during the hydration gap
3.Observe that some events are not handled or are dropped.

<!--
  <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hydration Gap Example</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/javascript">
    const { useState, useEffect } = React;

    // Simulate a delay in rendering (such as in Concurrent Mode or Suspense boundaries)
    const DelayedComponent = () => {
      const [hydrated, setHydrated] = useState(false);

      // Simulate the hydration process
      useEffect(() => {
        setTimeout(() => {
          setHydrated(true);
        }, 3000); // Delay for 3 seconds (simulating hydration gap)
      }, []);

      // Handle a click event that will be missed during the hydration gap
      const handleClick = () => {
        alert("Button clicked!");
      };

      if (!hydrated) {
        // Show a placeholder or loading state while waiting for hydration
        return <div>Loading...</div>;
      }

      // This button will miss the first click event if clicked before hydration is done
      return (
        <div>
          <button onClick={handleClick}>Click me!</button>
        </div>
      );
    };

    const App = () => {
      return (
        <div>
          <h1>Hydration Gap Example</h1>
          <DelayedComponent />
        </div>
      );
    };

    // Initially render the component server-side (SSRed content)
    ReactDOM.hydrate(<App />, document.getElementById('root'));

    // Simulate a client-side hydration
    document.addEventListener('DOMContentLoaded', () => {
      ReactDOM.hydrate(<App />, document.getElementById('root'));
    });
  </script>
</body>
</html>



Steps to Reproduce the Bug:
Initial Render:

The page renders with the message "Loading..." and the button appears after a 3-second delay. During this period, the component is "not hydrated."
User Interaction:

If the user clicks the button before the component is hydrated (within the 3-second delay), the event will be dropped or missed because the button is still in the "dehydrated" state.
Component Hydration:

After the delay, the component becomes hydrated and ready to handle events properly. Any further clicks will work as expected.


-->

Link to code example:

<!--
  import React, { useState, useEffect } from 'react';
import ReactDOM from 'react-dom';

// Simulate a delay in rendering (such as in Concurrent Mode or Suspense boundaries)
const DelayedComponent = () => {
  const [hydrated, setHydrated] = useState(false);

  // Simulate the hydration process
  useEffect(() => {
    setTimeout(() => {
      setHydrated(true);
    }, 3000); // Delay for 3 seconds (simulating hydration gap)
  }, []);

  // Handle a click event that will be missed during the hydration gap
  const handleClick = () => {
    alert("Button clicked!");
  };

  if (!hydrated) {
    // Show a placeholder or loading state while waiting for hydration
    return <div>Loading...</div>;
  }

  // This button will miss the first click event if clicked before hydration is done
  return (
    <div>
      <button onClick={handleClick}>Click me!</button>
    </div>
  );
};

const App = () => {
  return (
    <div>
      <h1>Hydration Gap Example</h1>
      <DelayedComponent />
    </div>
  );
};

// Initially render the component server-side (SSRed content)
ReactDOM.hydrate(<App />, document.getElementById('root'));

// For the sake of example, simulating a client-side hydration
document.addEventListener('DOMContentLoaded', () => {
  ReactDOM.hydrate(<App />, document.getElementById('root'));
});

-->

## The current behavior
Critical user interactions should be handled immediately, while less critical interactions can be replayed after hydration.

## The expected behavior
ome events are dropped due to the hydration gap, leading to a degraded user experience, especially with client-side interactions.


---

### Bug: Validate Target Containers in createRoot() Using Invariants

> Issue #32171 - [View on GitHub](https://github.com/facebook/react/issues/32171)

<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->
When using `ReactDOM.unstable_createRoot()` with an invalid container it doesnâ€™t throw a clear error. Instead, it leads to confusing issues like`Cannot call toLowerCase of undefined`.

React version:
React 19.0.0
## Steps To Reproduce

1. Call `ReactDOM.unstable_createRoot(<div>Hi</div>)` without a valid DOM container.
2. Try to use the returned root to render content.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->
Minimal code example
```
import ReactDOM from 'react-dom';

// Create a root with an invalid container
ReactDOM.unstable_createRoot(<div>Hello, world!</div>);

// Expectation: An error mentioning that the container is invalid.
```
## The current behavior
When an invalid container is passed to `createRoot()`, the function does not validate it. 
```
Cannot call toLowerCase of undefined
```
## The expected behavior
The createRoot() function should validate the container and show error.
```
unstable_createRoot(...): Target container is not a DOM element.
```



---

### Bug: sample test

> Issue #32169 - [View on GitHub](https://github.com/facebook/react/issues/32169)

<!--

-->Currently, suspended nodes in React are hidden using display: none inline style. However, this is susceptible to being overridden by external styles. The new approach applies display: none !important, ensuring React's visibility style takes precedence and preserves the state of hidden components.

React version: 16.8.6

## Steps To Reproduce

1. Trigger a suspended state in a React component.
2. Apply an external stylesheet that includes a display: block !important rule targeting the component's DOM node.
3. Observe that external styles can override the inline display: none.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior

External styles may override Reactâ€™s style if !important is not applied.

## The expected behavior
React's display: none should remain effective regardless of external CSS.


---

### Bug:

> Issue #32168 - [View on GitHub](https://github.com/facebook/react/issues/32168)

<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior


---

### [Compiler Bug]: Incorrect Handling of onLoad and onError Events in <link> Component

> Issue #32166 - [View on GitHub](https://github.com/facebook/react/issues/32166)

### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

-

### Repro steps

1.Render a <link> element with rel="preload", onLoad, and onError attributes.
2.Simulate onLoad and onError events in the environment.
3.Observe that the events are not handled as expected by the compiler.


### How often does this bug happen?

Every time

### What version of React are you using?

16.0.0

### What version of React Compiler are you using?

Latest version

---

